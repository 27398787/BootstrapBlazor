var recognizer = null;

export function bb_speech_recognizeOnce(obj, method) {
    var SpeechSDK = window.SpeechSDK;
    //var speechConfig = SpeechSDK.SpeechTranslationConfig.fromSubscription("b35c184e650c44d29734b634bda00789", "eastasia");
    var speechConfig = SpeechSDK.SpeechTranslationConfig.fromAuthorizationToken("eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiIsInR5cCI6IkpXVCJ9.eyJyZWdpb24iOiJlYXN0YXNpYSIsInN1YnNjcmlwdGlvbi1pZCI6ImFhNjg5YzVkYTIwNTQyNjU5ZjBmOGM0N2U4MjhkOTdiIiwicHJvZHVjdC1pZCI6IlNwZWVjaFNlcnZpY2VzLkYwIiwiY29nbml0aXZlLXNlcnZpY2VzLWVuZHBvaW50IjoiaHR0cHM6Ly9hcGkuY29nbml0aXZlLm1pY3Jvc29mdC5jb20vaW50ZXJuYWwvdjEuMC8iLCJhenVyZS1yZXNvdXJjZS1pZCI6Ii9zdWJzY3JpcHRpb25zLzg0ZjNmMmFiLTEyNzgtNDVkMS1hNmJjLWYyM2I1MzJkN2E4NC9yZXNvdXJjZUdyb3Vwcy9TcGVlY2gvcHJvdmlkZXJzL01pY3Jvc29mdC5Db2duaXRpdmVTZXJ2aWNlcy9hY2NvdW50cy9TcGVlY2gtTWV0YSIsInNjb3BlIjoic3BlZWNoc2VydmljZXMiLCJhdWQiOiJ1cm46bXMuc3BlZWNoc2VydmljZXMuZWFzdGFzaWEiLCJleHAiOjE2NDkzMDQwMzEsImlzcyI6InVybjptcy5jb2duaXRpdmVzZXJ2aWNlcyJ9.wYkb9NfGp6ZQLgI3BXeG9M1CmM6hqEfRNe8XMKAkgc4", "eastasia");
    speechConfig.speechRecognitionLanguage = "zh-CN";
    let language = "zh-CN"
    speechConfig.addTargetLanguage(language)

    var audioConfig = SpeechSDK.AudioConfig.fromDefaultMicrophoneInput();
    recognizer = new SpeechSDK.TranslationRecognizer(speechConfig, audioConfig);

    recognizer.recognizeOnceAsync(function (successfulResult) {
        recognizer.close();
        recognizer = null;
        console.log(successfulResult);
        obj.invokeMethodAsync(method, successfulResult.privText);
    }, function (err) {

    });
}

export function bb_close(obj, method) {
    if (recognizer != null) {
        recognizer.close();
    }
    obj.invokeMethodAsync(method, '');
}
