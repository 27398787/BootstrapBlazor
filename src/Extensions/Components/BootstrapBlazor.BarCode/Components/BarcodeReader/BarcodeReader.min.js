export function bb_barcode(t,i,r){const u=document.querySelector(t);n[t]={codeReader:new ZXing.BrowserMultiFormatReader,element:u,scanType:u.getAttribute("data-bb-scan")};let f=n[t];const e=f.codeReader;if(f.scanType==="Camera"){const i=()=>{r.invokeMethodAsync("Start");const n=u.getAttribute("data-bb-deviceId"),t=u.querySelector("video").getAttribute("id");e.decodeFromVideoDevice(n,t,(n,t)=>{n&&(console.log(n.text),r.invokeMethodAsync("GetResult",n.text),f.autoStop&&e.reset()),!t||t instanceof ZXing.NotFoundException||(console.error(t),r.invokeMethodAsync("GetError",t))})},o=()=>{e.reset(),r.invokeMethodAsync("Stop")};n[t]={...n[t],...{autoStart:u.getAttribute("data-bb-autostart")==="true",autoStop:u.getAttribute("data-bb-autostop")==="true",scanButton:u.querySelector('[data-bb-method="scan"]'),scan:i,stop:o}};f=n[t];e.getVideoInputDevices().then(n=>{r.invokeMethodAsync("InitDevices",n).then(()=>{f.autoStart&&n.length>0&&f.scanButton.click()})})}else{const i=()=>{const n=f.file.files;if(n.length!==0){const t=new FileReader;t.onloadend=function(n){e.decodeFromImageUrl(n.target.result).then(n=>{n&&(console.log(n.text),r.invokeMethodAsync("GetResult",n.text))}).catch(n=>{n&&(console.log(n),r.invokeMethodAsync("GetError",n.message))})};t.readAsDataURL(n[0])}},o=()=>{let n=u.querySelector('[type="file"]');n&&(bootstrap.EventHandler.off(n,"change",i),n.remove());n=document.createElement("input");n.setAttribute("type","file");n.setAttribute("hidden","true");n.setAttribute("accept","image/*");u.append(n);bootstrap.EventHandler.on(n,"change",i);return f.file=n,n},s=()=>{let n=o();n.click()};n[t]={...n[t],...{scanImage:s}};f=n[t]}e.eventHandler=()=>{let n=event.target;if(n.hasAttribute("[data-bb-method]")||(n=n.closest("[data-bb-method]")),n){const i=n.getAttribute("data-bb-method"),t=f[i];typeof t=="function"&&t()}};bootstrap.EventHandler.on(u,"click","[data-bb-method]",e.eventHandler)}export function bb_barcode_dispose(t){const i=n[t];if(i){const n=i.codeReader;n!=null&&(bootstrap.EventHandler.off(n.el,"click","[data-bb-method]",n.eventHandler),n.reset())}}const n={};